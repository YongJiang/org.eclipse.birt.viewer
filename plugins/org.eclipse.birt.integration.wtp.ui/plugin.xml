<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.0"?>
<plugin>

	<!--======================================================================================-->
	<!--         BIRT Web Project Wizard                                                      -->
	<!--======================================================================================-->
	
	<extension point="org.eclipse.ui.newWizards">	
		<wizard name="%birt.web.project.name" 
				class="org.eclipse.birt.integration.wtp.ui.internal.wizards.BirtWebProjectWizard"
				category="org.eclipse.birt.report.designer.ui.wizard.category"
				id="org.eclipse.birt.integration.wtp.ui.internal.wizards.BirtWebProjectCreationWizard"
				finalPerspective="org.eclipse.jst.j2ee.J2EEPerspective"
				project="true"
				icon="icons/create_project_wizard.gif">
			<description>
				%birt.web.project.description
			</description>			
		</wizard>		
	</extension>
	
	<extension point="org.eclipse.wst.common.ui.exampleProjectCreationWizard">
		<wizard	id="org.eclipse.birt.integration.wtp.ui.BirtExampleProjectCreationWizard">
			<projectsetup>
				<import	src="runtime/birt.zip" />
			</projectsetup>
		</wizard>
	</extension>
	
   <extension point="org.eclipse.ui.actionSets">
      <actionSet
            label="%birt.web.category.name"
            description="%birt.web.actionsets.description"
            visible="true"
            id="org.eclipse.birt.integration.wtp.ui.actionset">
            <action
               label="%create.birt.web.module"
               icon="icons/create_project_wizard.gif"
               tooltip="%create.birt.web.module"
               toolbarPath="J2EEMain"
               class="org.eclipse.birt.integration.wtp.ui.internal.actions.NewBirtWebComponentAction"
               id="org.eclipse.birt.wtp.ui.internal.actions.NewBirtWebComponentAction">
	        </action>

		    <action 
		   	   id="org.eclipse.birt.integration.wtp.ui.internal.actions.ImportBirtRuntimeAction"
			   menubarPath="project/additions"
			   label="%birt.action.importruntime.name"
			   tooltip="%birt.action.importruntime.name"
			   class="org.eclipse.birt.integration.wtp.ui.internal.actions.ImportBirtRuntimeAction"
			   enablesFor="1">
		   	   <enablement>
					<and>
						<objectClass name="org.eclipse.jdt.core.IJavaProject"/>
					</and>
				</enablement>            
		   </action>	        
      </actionSet>      
	</extension> 
	
	<extension
         point="org.eclipse.ui.popupMenus">
      <objectContribution
            objectClass="org.eclipse.core.resources.IProject"
            adaptable="true"
            id = "org.eclipse.birt.integration.wtp.ui.internal.actions.ImportBirtRuntimeAction">
         <menu
               label="%birt.web.category.name"
               path="additions"
               id="ImportBirtRuntimeAction">
            <separator
                  name="ImportBirtRuntimeAction">
            </separator>
         </menu>
        <action
				label="%birt.action.importruntime.name"
				tooltip="%birt.action.importruntime.name"
				menubarPath="ImportBirtRuntimeAction/ImportBirtRuntimeAction"
				class="org.eclipse.birt.integration.wtp.ui.internal.actions.ImportBirtRuntimeAction"
				enablesFor="1"
				id="org.eclipse.birt.integration.wtp.ui.internal.actions.ImportBirtRuntimeAction">
		</action>
		<enablement>
		  <adapt type="org.eclipse.core.resources.IProject">
		    <test forcePluginActivation="true"
				  property="org.eclipse.wst.common.project.facet.core.projectFacet"
				  value="jst.web"/>
		  </adapt>
		</enablement>
      </objectContribution>  
    </extension>

   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension targetID="org.eclipse.jst.j2ee.J2EEPerspective">
		<actionSet id="org.eclipse.birt.integration.wtp.ui.actionset"/> 		
      </perspectiveExtension>
   </extension>
          			
	<!-- Project Facets -->
	
	<extension point="org.eclipse.wst.common.project.facet.core.facets">
		
		<project-facet id="birt.runtime">
			<label>%BIRT_FACET_LABEL</label>
			<description>%BIRT_FACET_DESCRIPTION</description>
		</project-facet>
		
		<project-facet-version facet="birt.runtime" version="2.2.0">
			<constraint>
				<and>
					<requires facet="jst.web" version="[2.3"/>
					<requires facet="jst.java" version="[1.4"/>
					<conflicts group="group.birt.runtime"/>
				</and>
			</constraint>
			<group-member id="group.birt.runtime"/>
		</project-facet-version>
		
		<action facet="birt.runtime" version="2.2.0" type="INSTALL" id="birt.runtime.install">
			<delegate class="org.eclipse.birt.integration.wtp.ui.project.facet.BirtFacetInstallDelegate"/>
			<config-factory class="org.eclipse.birt.integration.wtp.ui.project.facet.BirtFacetInstallDataModelProvider"/>
		</action>
		
		<event-handler facet="birt.runtime" version="2.2.0" type="RUNTIME_CHANGED">
			<delegate class="org.eclipse.birt.integration.wtp.ui.project.facet.BirtFacetRuntimeChangedDelegate"/>
		</event-handler>
		
		<event-handler facet="birt.runtime" version="2.2.0" type="POST_INSTALL">
			<delegate class="org.eclipse.birt.integration.wtp.ui.project.facet.BirtFacetPostInstallDelegate"/>
		</event-handler>
		
		<preset id="preset.birt.runtime">
			<label>%BIRT_FACET_TEMPLATE_LABEL</label>
			<facet id="birt.runtime" version="2.2.0"/>
			<facet id="jst.java" version="1.4"/>
			<facet id="jst.web" version="2.3"/>
		</preset>
		
		<template id="template.birt.runtime">
			<label>%BIRT_FACET_TEMPLATE_LABEL</label>
			<fixed facet="birt.runtime"/>
			<fixed facet="jst.java"/>
			<fixed facet="jst.web"/>
		</template>
		
	</extension>
	
	<extension point="org.eclipse.wst.common.project.facet.core.runtimes">
		<supported>
			<facet id="birt.runtime" version="2.2.0"/>
			<runtime-component any="true"/>
		</supported>
	</extension>
      	
	<!--======================================================================================-->
	<!--         Templates                                                                    -->
	<!--======================================================================================-->
	<extension point="org.eclipse.ui.editors.templates">

		<contextType
			name="%JSP_New_context_type_Extension_Element.name"
			class="org.eclipse.jst.jsp.ui.internal.templates.TemplateContextTypeJSP"
			id="jsp_new" />

		<contextType
			name="%JSP_Tag_context_type_Extension_Element.name"
			class="org.eclipse.jst.jsp.ui.internal.templates.TemplateContextTypeJSP"
			id="jsp_tag" />
			
		<include
			file="templates/jspbirt-templates.xml"
			translations="$nl$/templates/jspbirt-templates.properties" />

	</extension>
	
	<!--======================================================================================-->
	<!--         Web Application Resources Settings                                           -->
	<!--======================================================================================-->
	
	<extension-point id="birtResourcesDefinition" name="%birtResourcesDefinition" schema="schema/birtResourcesDefinition.exsd"/>

	<extension
	       point="org.eclipse.birt.integration.wtp.ui.birtResourcesDefinition">
		
		<!-- Web Deployment Settings -->
		<webapp
			id="org.eclipse.birt.integration.wtp.ui.defaultBirtWebappDefinition">
			<context-param 
				name="BIRT_VIEWER_LOCALE"
				value="en-US"/>
				
			<context-param 
				name="BIRT_RESOURCE_PATH"
				value=""/>				

			<context-param 
				name="BIRT_VIEWER_WORKING_FOLDER"
				value=""/>	
				
			<context-param 
				name="BIRT_VIEWER_DOCUMENT_FOLDER"
				value="documents"/>		
						
			<context-param 
				name="BIRT_VIEWER_IMAGE_DIR"
				value="report/images"/>

			<context-param 
				name="BIRT_VIEWER_SCRIPTLIB_DIR"
				value="scriptlib"/>
				
			<context-param 
				name="BIRT_VIEWER_LOG_DIR"
				value="logs"/>

			<context-param 
				name="WORKING_FOLDER_ACCESS_ONLY"
				value="false"/>

			<context-param 
				name="BIRT_OVERWRITE_DOCUMENT"
				value="true"/>

			<context-param 
				name="BIRT_VIEWER_MAX_ROWS"
				value=""/>

			<context-param 
				name="BIRT_VIEWER_LOG_LEVEL"
				value="WARNING"/>
			
			<context-param 
				name="BIRT_VIEWER_CONFIG_FILE"
				value="WEB-INF/viewer.properties"/>
			
			<listener class="org.eclipse.birt.report.listener.ViewerServletContextListener"/>
			<listener class="org.eclipse.birt.report.listener.ViewerHttpSessionListener"/>
			
			<servlet
				name="ViewerServlet"
				class="org.eclipse.birt.report.servlet.ViewerServlet"/>			

			<servlet
				name="EngineServlet"
				class="org.eclipse.birt.report.servlet.BirtEngineServlet"/>

			<servlet-mapping
				name="ViewerServlet"
				uri="/frameset"/>				

			<servlet-mapping
				name="ViewerServlet"
				uri="/run"/>				

			<servlet-mapping
				name="EngineServlet"
				uri="/preview"/>
				
			<servlet-mapping
				name="EngineServlet"
				uri="/download"/>				

			<servlet-mapping
				name="EngineServlet"
				uri="/parameter"/>				
			
			<taglib
				uri="/birt.tld"
				location="/WEB-INF/tlds/birt.tld"/>
				
		</webapp>
		
		<!-- Conflict Resources Settings( Clear these resources when import ) -->
		<conflict
			id="org.eclipse.birt.integration.wtp.ui.defaultConflictResourcesDefinition">
			<folder path="/WEB-INF/platform"/>
			<folder path="/WEB-INF/lib">
				<file name="com.ibm.icu_"/>
				<file name="org.eclipse.emf.common_"/>
				<file name="org.eclipse.emf.ecore.xmi_"/>
				<file name="org.eclipse.emf.ecore_"/>
				<file name="org.eclipse.birt"/>
				<file name="coreapi.jar"/>
				<file name="dataadapterapi.jar"/>
				<file name="dteapi.jar"/>
				<file name="engineapi.jar"/>
				<file name="modelapi.jar"/>
				<file name="scriptapi.jar"/>
				<file name="viewservlets.jar"/>
			</folder>
		</conflict>	
		
	</extension>
	
		
</plugin>
